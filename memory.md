# 项目记忆文档

## 项目概述
医学PDF结构化信息提取系统，使用Qwen3-8B模型进行文档分类和信息提取。

## 当前版本: v7.2 (2026-01-08)

### 核心架构
1. **文档分类**: Qwen3-8B判断文档类型 (GUIDELINE/REVIEW/OTHER)
2. **动态Few-shot**: 根据类型加载对应的GPT-5.2预标注高质量示例
3. **结构化提取**: 提取元数据、推荐意见、关键发现、结论等

### 性能指标 (100个PDF测试)
- 成功率: 97%
- GPT-5.2抽样评分: 9.60/10
- ≥8分占比: 100%
- 平均耗时: 58秒/文件

## 关键配置

### vLLM服务
- 模型: Qwen3-8B fp16
- 端口: 8000
- API: `http://localhost:8000/v1/chat/completions`
- **重要**: 必须设置 `"chat_template_kwargs": {"enable_thinking": False}`

## 技术决策记录

### 为什么用fp16而不是int8?
- int8(GPTQ)在V100上速度慢14倍，成功率仅59%
- fp16性能稳定，推荐用于生产

### 为什么用动态few-shot?
- 静态few-shot(v6): 7.1分
- 动态few-shot(v7): 9.6分
- 不同文档类型结构差异大，需要针对性示例

## 已知限制
1. 长文档(>15页)会被截断
2. 复杂表格提取不完整
3. 部分PDF格式错误会导致失败(约3%)

## 优化历史

| 版本 | 日期 | 平均分 | 关键改进 |
|------|------|--------|----------|
| v4 | 01-05 | 4.1 | 基线版本 |
| v5 | 01-06 | 6.5 | 简化JSON结构 |
| v6 | 01-07 | 7.1 | 静态few-shot |
| v7.1 | 01-08 | 8.98 | 动态few-shot |
| v7.2 | 01-08 | 9.60 | JSON解析修复、长文档支持 |